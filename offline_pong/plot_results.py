#!/usr/bin/env python
import pandas as pd, matplotlib.pyplot as plt, seaborn as sns, json, sys
"""
Read the `monitor.csv` files automatically generated by d3rlpy
and the JSON logs we dumped from PPO, then overlay learning curves.
"""

sns.set_style("darkgrid")
dqn = pd.read_csv("dqn_logs.csv")      # columns: step,eval/average_reward
ppo = pd.read_csv("ppo_logs.csv")      # columns: step,average_reward

plt.plot(dqn["step"], dqn["eval/average_reward"], label="Offline DQN")
plt.plot(ppo["step"], ppo["average_reward"],    label="Offline PPO")
plt.xlabel("gradient steps")
plt.ylabel("Average Pong return")
plt.legend(loc="lower right")
plt.title("Learning curves â€“ Pong offline dataset")
plt.savefig("learning_curve.png", dpi=200)
plt.show()
